## 什么是组合模式

组合模式（Composite Pattern）是一种结构型设计模式，用于将对象组织成树形结构，以表示“部分-整体”的层次结构。它允许客户端统一对待单个对象和组合对象。以下通过一个简单的
Java 示例来解释组合模式的实现和使用场景。

## 例子：文件系统

假设我们要实现一个文件系统，包含文件和文件夹。文件夹可以包含文件或其他文件夹，客户端希望以统一的方式操作文件和文件夹（例如，显示大小或列出内容）。组合模式非常适合这种场景。

## 组合模式的关键组成部分

- 组件接口（Component）：FileSystemComponent 接口，定义所有组件（文件和文件夹）的公共操作，如 showDetails 和
  getSize。
- 叶子节点（Leaf）：File 类，表示树形结构的叶子节点，只实现基本操作。
- 组合节点（Composite）：Folder 类，表示可以包含其他组件（文件或文件夹）的节点，管理子节点并实现组件接口。
- 客户端：通过 FileSystemComponent 接口统一操作文件和文件夹。

## 组合模式的优点

- 统一接口：客户端可以通过同一接口操作单个对象（文件）和组合对象（文件夹），简化代码。
- 树形结构：适合表示层次结构，如文件系统、组织架构、UI 组件树。
- 扩展性：添加新类型的组件（如新文件类型）只需实现组件接口，符合开闭原则。
- 递归操作：组合节点通过递归调用子节点的相同方法，简化复杂操作。

## 使用场景

需要表示“部分-整体”的层次结构，如文件系统、公司组织架构、图形界面组件。
希望客户端统一对待单个对象和组合对象时。
需要支持递归操作的场景。

## 与其他模式的区别

- 与装饰者模式的区别：
    - 组合模式关注部分-整体的层次结构，统一对待叶子和组合节点。
    - 装饰者模式关注为对象动态添加职责，保持接口一致。
- 与桥接模式的区别：
    - 组合模式处理树形结构，强调统一操作。
    - 桥接模式分离抽象与实现，强调多维度独立扩展（如形状和颜色）。
- 与适配器模式的区别：
    - 组合模式处理同类对象的层次结构。
    - 适配器模式转换不兼容接口。

## 注意事项

- 性能开销：递归操作可能在深层树结构中影响性能，需优化递归深度或缓存结果。
- 一致性：叶子节点和组合节点需实现相同的接口，可能导致叶子节点实现一些不适用的方法（如文件不需要
  addComponent）。
- 深拷贝：本例未涉及深拷贝，但如果组件包含复杂对象（如列表），修改时需注意深拷贝以避免影响其他节点。

## 为什么使用组合模式？

如果不使用组合模式，客户端需要分别处理文件和文件夹：

- 需为文件和文件夹定义不同接口或类，增加客户端代码复杂度。
- 操作文件夹时需手动遍历子节点，代码重复且易出错。 组合模式通过统一接口和递归调用，简化了客户端代码，使操作树形结构更直观。

## 总结

这个示例通过文件系统展示了组合模式如何统一处理文件和文件夹，构建树形结构并支持递归操作。组合模式的核心在于通过统一接口简化客户端对复杂层次结构的访问，适用于任何需要表示部分-整体关系的场景。
